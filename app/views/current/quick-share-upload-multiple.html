{% extends prototypeVersion + '/layouts/layout-signed-in.html' %}

{% set pageName = "Search medical product evaluations" %}
{% set serviceHeader = "Search medical product evaluations" %}

{% block beforeContent %}
  {{ breadcrumb({
    items: [
      {
        text: "Home",
        href: "/"
      },
      {
        text: "Share evaluation",
        href: "/share-evaluation"
      }
    ],
    attributes: {
      "aria-label": "Breadcrumb"
    }
  }) }}
{% endblock %}

{% block content %}
<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-two-thirds">

  
    
  

    <form action="review-evaluation" method="post" enctype="multipart/form-data">

      <!-- Document Upload Section -->
      <div class="nhsuk-form-group">
        <fieldset class="nhsuk-fieldset">
          <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--l">
            <h1 class="nhsuk-fieldset__heading">
              Upload your document
            </h1>
             
          </legend>

           <p>Then, give us a few details to help other trusts find it.</p>
          
          <div class="nhsuk-hint">
            Formats accepted: PDF, Word, Excel
          </div>

          <div class="nhsuk-form-group">
            <label class="nhsuk-label" for="file-upload">
              Choose files to upload
            </label>
            <div class="nhsuk-hint" id="file-upload-hint">
              Maximum 10MB per file
            </div>
            <input class="nhsuk-input" id="file-upload" name="file-upload" type="file" multiple accept=".pdf,.doc,.docx,.xls,.xlsx" aria-describedby="file-upload-hint">
          </div>

          <!-- Uploaded file confirmation -->
          <div class="nhsuk-card nhsuk-u-margin-top-4" style="background: #e8edee;">
            <div class="nhsuk-card__content">
              <div style="display: flex; align-items: center; gap: 12px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="#007f3b">
                  <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h5v7h7v9H6z"/>
                </svg>
                <div>
                  <p class="nhsuk-u-margin-bottom-0"><strong>Q3 Evaluation-Report.pdf</strong></p>
                  <p class="nhsuk-body-s nhsuk-u-secondary-text-color nhsuk-u-margin-bottom-0">2.4 MB, uploaded just now</p>
                </div>
                <a href="#" class="nhsuk-link nhsuk-u-margin-left-auto">Remove</a>
              </div>
            </div>
          </div>

        </fieldset>
      </div>

      <!-- Alternative: Link to resource -->
      <div class="nhsuk-u-margin-top-4 nhsuk-u-margin-bottom-4">
        <p class="nhsuk-body-s nhsuk-u-secondary-text-color" style="text-align: center;">
          <strong>OR</strong>
        </p>
      </div>

      {{ input({
        label: {
          text: "Link to your document",
          classes: "nhsuk-label--s"
        },
        id: "document-link",
        name: "document-link",
        type: "url",
        hint: {
          text: "If you can't upload the document, provide a link to it"
        },
        attributes: {
          placeholder: "https://"
        }
      }) }}

      <hr class="nhsuk-section-break nhsuk-section-break--l nhsuk-section-break--visible">

      <!-- Multiple evaluations question -->
      <div class="nhsuk-form-group">
        <fieldset class="nhsuk-fieldset">
          <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
            <h2 class="nhsuk-fieldset__heading">
              How many products are evaluated in this document?
            </h2>
          </legend>
          <div class="nhsuk-hint">
            Some evaluation reports cover multiple products. We'll ask you for details about each one.
          </div>

          {{ radios({
            idPrefix: "evaluation-count",
            name: "evaluation-count",
            items: [
              {
                value: "1",
                text: "1 product"
              },
              {
                value: "2",
                text: "2 products"
              },
              {
                value: "3",
                text: "3 products",
                checked: true
              },
              {
                value: "more",
                text: "More than 3",
                conditional: {
                  html: '<div class="nhsuk-form-group">
                    <label class="nhsuk-label" for="evaluation-count-other">
                      How many products?
                    </label>
                    <input class="nhsuk-input nhsuk-input--width-3" id="evaluation-count-other" name="evaluation-count-other" type="number" min="4" max="10">
                  </div>'
                }
              }
            ]
          }) }}
        </fieldset>
      </div>

      <hr class="nhsuk-section-break nhsuk-section-break--l nhsuk-section-break--visible">

      <!-- Shared information section -->
      <h2 class="nhsuk-heading-m">About your trust</h2>
      <p class="nhsuk-body-s nhsuk-u-secondary-text-color">This information applies to all evaluations in your document.</p>

      {{ input({
        label: {
          text: "Your trust",
          classes: "nhsuk-label--s"
        },
        id: "trust-name",
        name: "trust-name",
        value: "Mid England NHS Foundation Trust",
        attributes: {
          readonly: "readonly"
        }
      }) }}

      {{ select({
        id: "trust-department",
        name: "trust-department",
        label: {
          text: "Department",
          classes: "nhsuk-label--s"
        },
        hint: {
          text: "Select the department that conducted this evaluation"
        },
        items: [
          { value: "", text: "Select a department", selected: true },
          { value: "anaesthetics", text: "Anaesthetics" },
          { value: "cardiology", text: "Cardiology" },
          { value: "clinical-engineering", text: "Clinical Engineering" },
          { value: "critical-care", text: "Critical Care / ICU" },
          { value: "diagnostics", text: "Diagnostics and Imaging" },
          { value: "emergency", text: "Emergency Medicine" },
          { value: "general-surgery", text: "General Surgery" },
          { value: "haematology", text: "Haematology" },
          { value: "infection-control", text: "Infection Control" },
          { value: "maternity", text: "Maternity and Obstetrics" },
          { value: "medical-devices", text: "Medical Devices" },
          { value: "oncology", text: "Oncology" },
          { value: "paediatrics", text: "Paediatrics" },
          { value: "pathology", text: "Pathology" },
          { value: "pharmacy", text: "Pharmacy" },
          { value: "procurement", text: "Procurement" },
          { value: "radiology", text: "Radiology" },
          { value: "renal", text: "Renal Medicine" },
          { value: "respiratory", text: "Respiratory Medicine" },
          { value: "theatre", text: "Theatre and Perioperative" },
          { value: "other", text: "Other" }
        ]
      }) }}

      {{ input({
        label: {
          text: "Lead clinician",
          classes: "nhsuk-label--s"
        },
        id: "lead-clinician",
        name: "lead-clinician",
        hint: {
          text: "Name of the clinician who led or supervised this evaluation"
        }
      }) }}

      <hr class="nhsuk-section-break nhsuk-section-break--l nhsuk-section-break--visible">

      <!-- Evaluation 1 -->
      <div class="nhsuk-card nhsuk-u-margin-bottom-4">
        <div class="nhsuk-card__content">
          <div class="nhsuk-u-margin-bottom-3" style="display: flex; justify-content: space-between; align-items: center;">
            <h3 class="nhsuk-heading-m nhsuk-u-margin-bottom-0">
              <span class="nhsuk-tag nhsuk-tag--blue nhsuk-u-margin-right-2">1 of 3</span>
              Product evaluation
            </h3>
          </div>

          {% include "includes/products.html" %}

          {% from "date-input/macro.njk" import dateInput %}

          {{ dateInput({
            id: "date-of-evaluation-1",
            namePrefix: "date-of-evaluation-1",
            fieldset: {
              legend: {
                text: "Date of evaluation",
                classes: "nhsuk-fieldset__legend--s"
              }
            },
            hint: {
              text: "Approximate date is fine"
            },
            items: [
              {
                name: "day",
                classes: "nhsuk-input--width-2"
              },
              {
                name: "month",
                classes: "nhsuk-input--width-2"
              },
              {
                name: "year",
                classes: "nhsuk-input--width-4"
              }
            ]
          }) }}

          {{ radios({
            idPrefix: "recommendation-1",
            name: "recommendation-1",
            fieldset: {
              legend: {
                text: "Did you procure this product following your evaluation?",
                classes: "nhsuk-fieldset__legend--s"
              }
            },
            classes: "nhsuk-radios--inline",
            items: [
              {
                value: "yes",
                text: "Yes"
              },
              {
                value: "no",
                text: "No"
              }
            ]
          }) }}

          {{ textarea({
            name: "summary-1",
            id: "summary-1",
            label: {
              text: "Brief summary (optional)",
              classes: "nhsuk-label--s"
            },
            hint: {
              text: "A one-sentence summary of your key finding for this product"
            },
            rows: "2"
          }) }}

          {{ input({
            label: {
              text: "Page or section reference (optional)",
              classes: "nhsuk-label--s"
            },
            id: "page-ref-1",
            name: "page-ref-1",
            classes: "nhsuk-input--width-10",
            hint: {
              text: "Help others find this evaluation in the document. For example, 'Pages 1-12' or 'Section 2'."
            }
          }) }}

        </div>
      </div>

      <!-- Evaluation 2 -->
      <div class="nhsuk-card nhsuk-u-margin-bottom-4">
        <div class="nhsuk-card__content">
          <div class="nhsuk-u-margin-bottom-3" style="display: flex; justify-content: space-between; align-items: center;">
            <h3 class="nhsuk-heading-m nhsuk-u-margin-bottom-0">
              <span class="nhsuk-tag nhsuk-tag--blue nhsuk-u-margin-right-2">2 of 3</span>
              Product evaluation
            </h3>
          </div>

          {{ select({
            id: "product-picker-2",
            name: "product-picker-2",
            label: {
              text: "Product evaluated",
              classes: "nhsuk-label--s"
            },
            items: [
              { value: "", text: "Select a product" },
              { value: "smartpump-infusion-device-pro", text: "SmartPump Infusion Device Pro" },
              { value: "medflow-infusion-system", text: "MedFlow Infusion System 3000", selected: true },
              { value: "vitalguard-patient-monitor", text: "VitalGuard Patient Monitor X1" },
              { value: "scanmaster-ultrasound", text: "ScanMaster Portable Ultrasound" },
              { value: "other", text: "Other - I'll enter the name" }
            ]
          }) }}

          {{ dateInput({
            id: "date-of-evaluation-2",
            namePrefix: "date-of-evaluation-2",
            fieldset: {
              legend: {
                text: "Date of evaluation",
                classes: "nhsuk-fieldset__legend--s"
              }
            },
            hint: {
              text: "Approximate date is fine"
            },
            items: [
              {
                name: "day",
                classes: "nhsuk-input--width-2"
              },
              {
                name: "month",
                classes: "nhsuk-input--width-2"
              },
              {
                name: "year",
                classes: "nhsuk-input--width-4"
              }
            ]
          }) }}

          {{ radios({
            idPrefix: "recommendation-2",
            name: "recommendation-2",
            fieldset: {
              legend: {
                text: "Did you procure this product following your evaluation?",
                classes: "nhsuk-fieldset__legend--s"
              }
            },
            classes: "nhsuk-radios--inline",
            items: [
              {
                value: "yes",
                text: "Yes"
              },
              {
                value: "no",
                text: "No"
              }
            ]
          }) }}

          {{ textarea({
            name: "summary-2",
            id: "summary-2",
            label: {
              text: "Brief summary (optional)",
              classes: "nhsuk-label--s"
            },
            hint: {
              text: "A one-sentence summary of your key finding for this product"
            },
            rows: "2"
          }) }}

          {{ input({
            label: {
              text: "Page or section reference (optional)",
              classes: "nhsuk-label--s"
            },
            id: "page-ref-2",
            name: "page-ref-2",
            classes: "nhsuk-input--width-10",
            hint: {
              text: "Help others find this evaluation in the document. For example, 'Pages 13-24' or 'Section 3'."
            }
          }) }}

        </div>
      </div>

      <!-- Evaluation 3 -->
      <div class="nhsuk-card nhsuk-u-margin-bottom-4">
        <div class="nhsuk-card__content">
          <div class="nhsuk-u-margin-bottom-3" style="display: flex; justify-content: space-between; align-items: center;">
            <h3 class="nhsuk-heading-m nhsuk-u-margin-bottom-0">
              <span class="nhsuk-tag nhsuk-tag--blue nhsuk-u-margin-right-2">3 of 3</span>
              Product evaluation
            </h3>
          </div>

          {{ select({
            id: "product-picker-3",
            name: "product-picker-3",
            label: {
              text: "Product evaluated",
              classes: "nhsuk-label--s"
            },
            items: [
              { value: "", text: "Select a product" },
              { value: "smartpump-infusion-device-pro", text: "SmartPump Infusion Device Pro" },
              { value: "medflow-infusion-system", text: "MedFlow Infusion System 3000" },
              { value: "vitalguard-patient-monitor", text: "VitalGuard Patient Monitor X1", selected: true },
              { value: "scanmaster-ultrasound", text: "ScanMaster Portable Ultrasound" },
              { value: "other", text: "Other - I'll enter the name" }
            ]
          }) }}

          {{ dateInput({
            id: "date-of-evaluation-3",
            namePrefix: "date-of-evaluation-3",
            fieldset: {
              legend: {
                text: "Date of evaluation",
                classes: "nhsuk-fieldset__legend--s"
              }
            },
            hint: {
              text: "Approximate date is fine"
            },
            items: [
              {
                name: "day",
                classes: "nhsuk-input--width-2"
              },
              {
                name: "month",
                classes: "nhsuk-input--width-2"
              },
              {
                name: "year",
                classes: "nhsuk-input--width-4"
              }
            ]
          }) }}

          {{ radios({
            idPrefix: "recommendation-3",
            name: "recommendation-3",
            fieldset: {
              legend: {
                text: "Did you procure this product following your evaluation?",
                classes: "nhsuk-fieldset__legend--s"
              }
            },
            classes: "nhsuk-radios--inline",
            items: [
              {
                value: "yes",
                text: "Yes"
              },
              {
                value: "no",
                text: "No"
              }
            ]
          }) }}

          {{ textarea({
            name: "summary-3",
            id: "summary-3",
            label: {
              text: "Brief summary (optional)",
              classes: "nhsuk-label--s"
            },
            hint: {
              text: "A one-sentence summary of your key finding for this product"
            },
            rows: "2"
          }) }}

          {{ input({
            label: {
              text: "Page or section reference (optional)",
              classes: "nhsuk-label--s"
            },
            id: "page-ref-3",
            name: "page-ref-3",
            classes: "nhsuk-input--width-10",
            hint: {
              text: "Help others find this evaluation in the document. For example, 'Pages 25-36' or 'Section 4'."
            }
          }) }}

        </div>
      </div>

      <hr class="nhsuk-section-break nhsuk-section-break--l nhsuk-section-break--visible">

      <!-- Contact section -->
      <h2 class="nhsuk-heading-m">Contact for queries</h2>
      <p class="nhsuk-body-s nhsuk-u-secondary-text-color">Other trusts may want to ask about your evaluations.</p>

      {{ input({
        label: {
          text: "Contact name",
          classes: "nhsuk-label--s"
        },
        id: "contact-name",
        name: "contact-name",
        hint: {
          text: "The person other trusts should contact with questions"
        }
      }) }}

      {{ input({
        label: {
          text: "Email address",
          classes: "nhsuk-label--s"
        },
        id: "contact-email",
        name: "contact-email",
        type: "email"
      }) }}

      {{ input({
        label: {
          text: "UK phone number (optional)",
          classes: "nhsuk-label--s"
        },
        id: "contact-phone",
        name: "contact-phone",
        type: "tel",
        classes: "nhsuk-input--width-20",
        hint: {
          text: "For example, 07700 900000 or 0113 496 0000"
        },
        attributes: {
          autocomplete: "tel"
        }
      }) }}

      {{ checkboxes({
        idPrefix: "contact-topics",
        name: "contact-topics",
        fieldset: {
          legend: {
            text: "What are you willing to discuss?",
            classes: "nhsuk-fieldset__legend--s"
          }
        },
        hint: {
          text: "Select all topics you're happy to be contacted about"
        },
        items: [
          {
            value: "clinical-outcomes",
            text: "Clinical outcomes and effectiveness",
            hint: {
              text: "Patient outcomes, safety data, clinical performance"
            }
          },
          {
            value: "evaluation-methodology",
            text: "Evaluation methodology",
            hint: {
              text: "How you conducted the evaluation, criteria used, lessons learned"
            }
          },
          {
            value: "implementation",
            text: "Implementation and training",
            hint: {
              text: "Rollout experience, staff training, change management"
            }
          },
          {
            value: "integration",
            text: "System integration",
            hint: {
              text: "IT integration, interoperability, data migration"
            }
          },
          {
            value: "procurement-process",
            text: "Procurement process",
            hint: {
              text: "Tender approach, contract terms, supplier engagement"
            }
          },
          {
            value: "costs",
            text: "Costs and value",
            hint: {
              text: "Pricing, total cost of ownership, return on investment"
            }
          },
          {
            value: "supplier-experience",
            text: "Supplier experience",
            hint: {
              text: "Working relationship, support quality, responsiveness"
            }
          }
        ]
      }) }}

      <div class="nhsuk-warning-callout nhsuk-u-margin-top-6">
        <h3 class="nhsuk-warning-callout__label">
          <span role="text">
            <span class="nhsuk-u-visually-hidden">Important: </span>
            Who can see this?
          </span>
        </h3>
        <p>Your evaluations will be visible to <strong>all NHS trusts</strong> using this service. You can change this on the next screen.</p>
        <p class="nhsuk-body-s">All 3 product evaluations will be linked to the same uploaded document.</p>
      </div>

      <div class="nhsuk-form-group nhsuk-u-margin-top-6">
        <button class="nhsuk-button" data-module="nhsuk-button" type="submit">
          Review and submit 3 evaluations
        </button>
        <p>
          <a href="/share-evaluation-choice" class="nhsuk-link nhsuk-link--no-visited-state">Cancel</a>
        </p>
      </div>

    </form>

  </div>

  <!-- Summary sidebar -->
  <div class="nhsuk-grid-column-one-third">
    <div class="nhsuk-card" style="position: sticky; top: 24px;">
      <div class="nhsuk-card__content">
        <h3 class="nhsuk-heading-s nhsuk-u-margin-bottom-3">Summary</h3>
        
        <dl class="nhsuk-summary-list nhsuk-summary-list--no-border">
          <div class="nhsuk-summary-list__row">
            <dt class="nhsuk-summary-list__key nhsuk-body-s">Document</dt>
            <dd class="nhsuk-summary-list__value nhsuk-body-s">1 file uploaded</dd>
          </div>
          <div class="nhsuk-summary-list__row">
            <dt class="nhsuk-summary-list__key nhsuk-body-s">Evaluations</dt>
            <dd class="nhsuk-summary-list__value nhsuk-body-s">3 products</dd>
          </div>
        </dl>

        <hr class="nhsuk-section-break nhsuk-section-break--visible nhsuk-u-margin-top-3 nhsuk-u-margin-bottom-3">

        <p class="nhsuk-body-s nhsuk-u-secondary-text-color nhsuk-u-margin-bottom-0">
          Each product will appear as a separate evaluation, linked to the same document.
        </p>
      </div>
    </div>
  </div>

</div>

<script>
// Simple file upload preview
document.getElementById('file-upload').addEventListener('change', function(e) {
  // File handling would go here
});
</script>
{% endblock %}

{% block pageScripts %}
<script src="https://cdn.jsdelivr.net/npm/accessible-autocomplete@2.0.4/dist/accessible-autocomplete.min.js"></script>
<script type="text/javascript">
  accessibleAutocomplete.enhanceSelectElement({
    defaultValue: '',
    selectElement: document.querySelector('#product-picker')
  })
</script>
{% endblock %}